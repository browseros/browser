<div class="app-bar">
    <div class="app-bar-left">
        <div class="app-actions">
            <div class="dropdown">
                <button class="action-button" (click)="toggleDropdown()" title="Menu">
                    <i class="bi bi-list"></i>
                </button>
                <div class="dropdown-menu" [class.show]="isDropdownOpen">
                    <button class="dropdown-item" (click)="onBtnSettings.emit()">
                        <i class="bi bi-gear"></i>
                        Settings
                    </button>
                </div>
            </div>
            <button class="action-button" (click)="onBtnAIAssistant.emit()" title="AI Assistant">
                <i class="bi bi-robot"></i>
            </button>
        </div>
    </div>
    
    <div class="app-bar-center">
        <div class="search-container">
            <i class="bi bi-search search-icon"></i>
            <input type="text" 
                   class="search-input" 
                   placeholder="Search URL or App"
                   [value]="currentTab?.url || ''"
                   (click)="onEnteredSearchBox.emit()"/>
        </div>
    </div>

    <div class="app-bar-right">
        <div class="app-list">
            <ng-container *ngFor="let app of apps">
                <div class="app-group"
                     [class.active]="currentApp?.id === app.id">
                    <!-- App Header -->
                    <div class="app-header"
                         (click)="handleAppSelect(app)"
                         (contextmenu)="handleContextMenu(app)"
                         (dblclick)="handleAppBarDoubleClick($event)">
                        <img [src]="app.icon" *ngIf="app.icon" class="app-icon" alt=""/>
                        <i *ngIf="!app.icon" class="bi bi-window app-icon"></i>
                        <span class="app-title">{{getHost(app)}}</span>
                        <button class="app-close" 
                                (click)="handleAppClose($event, app)"
                                title="Close app">
                            <i class="bi bi-x"></i>
                        </button>
                    </div>
                    
                    <!-- App Tabs -->
                    <div class="app-tabs">
                        <ng-container *ngFor="let tab of tabs">
                            <div *ngIf="tab.appId === app.id"
                                 class="tab-item"
                                 [class.active]="currentTab?.id === tab.id"
                                 [style.display]="currentApp?.id === app.id ? 'flex' : 'none'"
                                 (click)="handleTabSelect(tab)"
                                 (contextmenu)="handleTabContextMenu(tab)">
                                <img [src]="tab.icon" *ngIf="tab.icon" class="tab-icon" alt=""/>
                                <i *ngIf="!tab.icon" class="bi bi-globe tab-icon"></i>
                                <span class="tab-title">{{tab.title || 'New Tab'}}</span>
                                <button class="tab-close" 
                                        (click)="handleTabClose($event, tab)"
                                        title="Close tab">
                                    <i class="bi bi-x"></i>
                                </button>
                            </div>
                        </ng-container>
                    </div>
                </div>
            </ng-container>
        </div>
    </div>

    <div class="window-controls" (contextmenu)="handleWindowControlsContextMenu($event)">
        <button class="window-button minimize" title="Minimize" (click)="handleMinimize()">
            <i class="bi bi-dash-lg"></i>
        </button>
        <button class="window-button maximize" title="Maximize" (click)="handleMaximize()">
            <i class="bi bi-square"></i>
        </button>
        <button class="window-button close" title="Close" (click)="handleClose()">
            <i class="bi bi-x-lg"></i>
        </button>
    </div>
</div>